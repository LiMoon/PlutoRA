//===== rAthena Script =======================================
// - 達那托斯之塔 任務腳本 - 
//===== By: ==================================================
//= Muad_Dib
//= 中文化:YANPO[PlutoEA]
//===== Current Version: =====================================
//= 1.0a
//===== Compatible With: =====================================
//= rAthena SVN
//===== Description: =========================================
//= [Official Conversion]
//= Episode 13.1 Thanatos Tower quest.
//===== Additional Comments: =================================
//= 1.0 Adapted from official release. [Euphy]
//= 1.0a Added 'npcskill' command. [Euphy]
//============================================================

hu_fild01,140,163,5	script	進出 管理員	852,3,3,{
	mes "[賈泰]";
	mes "你好嗎，";
	mes "我是負責此處'達納托斯 塔台'";
	mes "進出的管理員，";
	mes "我叫做'賈泰 寧'，";
	mes "請問需要幫忙嗎?";
	next;
	switch( select( "是達納托斯 塔台嗎?:我可以進入裡面嗎?:進入塔台:不用了" )) {
	case 1:
		mes "[賈泰]";
		mes "是的，本塔台正是";
		mes "'達納托斯 塔台' 沒錯,";
		mes "本來將廢棄的塔台由我們";
		mes "雷根貝勒發現之後進行大規模的";
		mes "清除魔物及透過整修工作後,";
		mes "目前已成為當地的";
		mes "觀光勝地了";
		next;
		mes "[賈泰]";
		mes "起初發現這塔台當時,該區附近";
		mes "原本有一塊石板上印有達納托斯的";
		mes "名字，所以就取名為";
		mes "達納托斯 塔台了";
		next;
		mes "[賈泰]";
		mes "那之後不懈地進行開發工作，";
		mes "把原本存在於塔台內的魔物中，";
		mes "將 1、2樓部份的魔物大致上";
		mes "清除完畢，已煥然一新成為一般人";
		mes "皆可安全地自由進出觀賞水準的";
		mes "空間後開放當中";
		next;
		mes "[賈泰]";
		mes "3樓以上的區域目前仍在開發中，";
		mes "因此正在召募可以協同";
		mes "清除魔物的";
		mes "有志人士";
		next;
		mes "[賈泰]";
		mes "針對此事項待進入內部後，";
		mes "會有更加詳細的說明";
		next;
		mes "[賈泰]";
		mes "若有疑問事項的話，";
		mes "請詢問內部的";
		mes "服務人員吧";
		close;
	case 2:
		mes "[賈泰]";
		mes "當然可以進去，";
		mes "已開放給";
		mes "一般人士";
		next;
		mes "[賈泰]";
		mes "只是開放區域僅限於1、2樓，";
		mes "還有...";
		mes "需支付一些入場費，";
		mes "或許會覺得有點貴，";
		mes "但只要一進去裡面，";
		mes "保證不會感到貴喔";
		next;
		mes "[賈泰]";
		mes "每人的入場費是'5000金幣'，";
		mes "若常常利用的話，應該";
		mes "會有一些折扣優惠，";
		mes "還有對協助我們的";
		mes "人士,也給予相同的";
		mes "若干折扣優惠";
		close;
	case 3:
		mes "[賈泰]";
		mes "請問你要進去嗎?";
		mes "入場費是 ^FF00001人 5000金幣^000000";
		next;
		switch(select("進去:下一次")) {
		case 1:
			if (thana_tower > 0) {
				mes "[賈泰]";
				mes "啊你是 "+strcharinfo(0)+"";
				mes "你是又來工作的嗎?";
				mes "如同你聽到的一樣是 3000金幣";
				next;
				switch(select("進去:下一次")) {
				case 1:
					if (Zeny > 2999) {
						mes "[賈泰]";
						mes "謝謝你";
						mes "那麼繼續拜託你辛苦囉";
						set Zeny, Zeny - 3000;
						close2;
						warp "tha_scene01",131,220;
						end;
					}
					mes "[賈泰]";
					mes "真是...";
					mes "你攜帶的金幣好像不足，";
					mes "我會等你的 請快去補足金幣後再來吧";
					close;
				case 2:
					mes "[賈泰]";
					mes "你好像在忙別的事啊，";
					mes "那麼請你下次再來拜訪吧";
					close;
				}
			}
			if (Zeny > 4999) {
				mes "[賈泰]";
				mes "謝謝你，";
				mes "祝你有個美好的回憶...";
				mes "那麼...";
				close2;
				set Zeny, Zeny - 5000;
				warp "tha_scene01",131,220;
				end;
			}
			mes "[賈泰]";
			mes "真是...";
			mes "你攜帶的金幣好像不足，";
			mes "我會等你的 請快去補足金幣後再來吧";
			close;
		case 2:
			mes "[賈泰]";
			mes "那麼請你下次再來使用吧";
			close;
		}
	case 4:
		mes "[賈泰]";
		mes "啊，是嗎?";
		mes "若跟此處 '達納托斯 塔台'";
		mes "有關的事情的話，";
		mes "請再來找我吧";
		close;
	}

OnTouch:
	mes "[進出 管理員]";
	mes "啊....";
	mes "請你等一下，";
	mes "這裡是'雷根貝勒'所管轄的";
	mes "地區，是有限制進出的";
	close;
}

tha_t01,149,78,4	script	服務人員	90,{
	if (thana_tower == 0) {
		mes "[狄材]";
		mes "你好嗎?";
		mes "歡迎你到由雷根貝勒開發及";
		mes "開放中的這裡 '達納托斯 塔台'，";
		mes "請問需要幫忙嗎?";
		next;
		switch(select("詢問有關達納托斯 塔台的事情:聽說你們在召募人..:沒事")) {
		case 1:
			mes "[狄材]";
			mes "這裡 '達納托斯 塔台'，";
			mes "無法確切的說明是由誰建造，";
			mes "及它的起源又是什麼樣的建築物";
			next;
			mes "[狄材]";
			mes "針對此事是有幾項假定，";
			mes "例如'在1000年前的戰爭當時，";
			mes "是魔族需要而建設'，";
			mes "'是某位魔法師的研究所，";
			mes "是某位英雄殺死魔王後，";
			mes "為了紀念他而設立' 的等等...";
			next;
			mes "[狄材]";
			mes "不過正確的起源沒有人知道，";
			mes "雖然我們雷根貝勒";
			mes "經過長時間不斷的挖掘";
			mes "與研究,但仍未能發現";
			mes "確切的起源";
			next;
			mes "[狄材]";
			mes "再加上整個塔台的內部";
			mes "生存著為數眾多的魔物，";
			mes "因與牠們戰鬥而";
			mes "犧牲了很多人員";
			next;
			mes "[狄材]";
			mes "不過我們雷根貝勒確信";
			mes "'這裡'達納托斯 塔台'保存著許多秘密";
			mes "許多秘密，以及";
			mes "判斷那秘密對人類發展";
			mes "扮演關鍵的角色，所以";
			mes "甘冒犧牲的危險進行挖掘工作";
			next;
			mes "[狄材]";
			mes "結果在全部12層樓之中，";
			mes "已完成開發的是1、2樓，";
			mes "目前對 3、4樓部份正在加緊";
			mes "追加開發當中";
			next;
			mes "[狄材]";
			mes "雖然受到魔物群的頑強";
			mes "抵抗而有阻礙,但幸好";
			mes "有賴眾人支援清除魔物";
			mes "而成果豐碩";
			next;
			mes "[狄材]";
			mes "以現在的情況來看，過不久";
			mes "3、4樓應該就能開發完成";
			next;
			switch(select("魔物嗎?:清除魔物?:.........")) {
			case 1:
				mes "[狄材]";
				mes "是的，自從我們開發";
				mes "這裡之後,就開始出現";
				mes "魔物了";
				next;
				mes "[狄材]";
				mes "奇特之處是不知道牠們";
				mes "從哪裡冒出來，";
				mes "以及牠們擁有類似";
				mes "天使般的形狀";
				next;
				mes "[狄材]";
				mes "所以某些人看過牠們後,";
				mes "稱呼牠們為神之使者，";
				mes "可是神之使者沒有理由要殺害";
				mes "我們人類不是嗎?";
				next;
				mes "[狄材]";
				mes "於是我們委託朱諾的賢者學會";
				mes "去調查的結果，查出事實上";
				mes "牠們只不過是";
				mes "披著天使外表的";
				mes "魔物而已";
				next;
				mes "[狄材]";
				mes "所以我們開始更加強去";
				mes "消滅牠們，自此";
				mes "與牠們的戰鬥,";
				mes "一直延續到今天";
				close;
			case 2:
				break;
			case 3:
				mes "[狄材]";
				mes "'以上是'達那托斯 塔台內部服務人員，";
				mes "'狄材 拉帕'，";
				mes "祝你有個愉快的時間";
				close;
			}
		case 2:
			mes "[狄材]";
			mes "不知道你是否向入口的";
			mes "服務人員聽取解說，";
			mes "我們雷根貝勒為了3、4樓，";
			mes "以及那以上樓層的挖掘與";
			mes "開發，正在召募";
			mes "約聘人員";
			next;
			mes "[狄材]";
			mes "把它想成傭兵的一種";
			mes "就可以了，首先與我們訂立";
			mes "契約的人，我們會針對一般人";
			mes "限制進入的 3樓以上之樓層，";
			mes "賦予自由進出的權限";
			next;
			mes "[狄材]";
			mes "如果帶來解決該魔物的";
			mes "相關證據時，我們就會給付";
			mes "相對價值的補償";
			next;
			mes "[狄材]";
			mes "如果你有意願申請加入的話，";
			mes "請透過我";
			mes "報名吧";
			next;
			goto L_Contract;
		case 3:
			mes "[狄材]";
			mes "'以上是'達那托斯 塔台內部服務人員，";
			mes "'狄材 拉帕'，";
			mes "祝你有個愉快的時間";
			close;
		}
	}
	mes "[狄材]";
	mes "更詳細的事項會由 2樓的";
	mes "服務人員和我旁邊的服務人員";
	mes "進行說明的，";
	mes "謝謝你";
	close;

L_Contract:
	switch(select("下一次:我要申請")) {
	case 1:
		mes "[狄材]";
		mes "我們隨時開放申請報名，";
		mes "如果改變主意的話，";
		mes "再來找我吧";
		close;
	case 2:
		mes "[狄材]";
		mes "好的，謝謝你，";
		mes "那麼請填一下這份";
		mes "表格好嗎?";
		mes "像是簡易的同意書";
		next;
		mes "[狄材]";
		mes "啊..還有請問大名是.....";
		mes ""+strcharinfo(0)+" 對嗎?";
		next;
		select("是的");
		mes "[狄材]";
		mes "那麼請你先仔細閱讀這裡後,";
		mes "再簽名吧";
		next;
		mes "她把寫滿密密麻麻小字的";
		mes "紙張遞給了你";
		next;
		mes "- 契約書 -";
		mes "1.";
		mes "本契約書是雷根貝勒(以下簡稱'甲方')和";
		mes ""+strcharinfo(0)+"(以下簡稱'乙方')之間有契約效力。";
		mes "1-1. 本契約的名稱就叫做'甲方'和";
		mes "'乙方'之間的傭兵契約。";
		mes "2.";
		mes "本契約的效力是從雙方在契約上簽名後開";
		mes "始。";
		mes "3.";
		mes "有關任務的成果是依據'甲方'所公怖的證";
		mes "據才能確定為成果。";
		mes "3-1. 證據如下:";
		mes "4.";
		mes "當每一種的證物限於搜集一定數量以上回";
		mes "來的情形下,'甲方'得以向'乙方'給付補";
		mes "償。";
		mes "4-1. 補償如下:";
		mes "........";
		mes "...........";
		mes "..............";
		mes "13. 本契約書的效力僅限於達納托斯";
		mes "塔台內,在其它區域則喪失效力。";
		mes "...................";
		mes "...追加的是補償'甲方'承諾給予'乙方'";
		mes "進出達納托斯";
		mes "塔台的折扣優惠,其費用由5000金幣優惠";
		mes "為3000金幣。";
		mes ".......";
		mes "............";
		mes "       雷根貝勒";
		mes " "+strcharinfo(0)+"";
		next;
		switch( select( "簽名:不簽名" ) ) {
		case 1:
			mes "你在騰有兩份相同內容的契約書上簽了名";
			next;
			mes "[狄材]";
			mes "謝謝你，";
			mes "這樣我們之間的傭兵契約";
			mes "已簽定完成了";
			next;
			mes "[狄材]";
			mes "只是，本契約書的效力唯有在這裡";
			mes "達納達納托斯 塔台內有效";
			mes "所以勿需擔心";
			next;
			mes "[狄材]";
			mes "詳細事項請參考契約書記載的";
			mes "內容，3樓進出由 2樓的服務人員";
			mes "負責，有關成果的補償";
			mes "是由我旁邊'李業'小姐";
			mes "負責管理";
			next;
			mes "[狄材]";
			mes "還有它的相關細節說明，";
			mes "由 2樓的服務人員負責，";
			mes "那麼祝你有豐碩的成果";
			set thana_quest,1;
			close;
		case 2:
			mes "[狄材]";
			mes "唉喲....";
			mes "你並沒有簽名呢?";
			mes "嗯... 你應該是有不滿意的";
			mes "部份吧";
			next;
			mes "[狄材]";
			mes "那麼就沒辦法了，";
			mes "如果你改變主意的話，，";
			mes "再來找我吧";
			close;
		}
	}
}

tha_t01,140,78,4	script	服務人員#reward	831,{
	mes "[李業]";
	if (thana_tower == 0) {
		mes "你好嗎，";
		mes "我是負責和'達納托斯 塔台契約'";
		mes "補償有關的李業 克妮姬葉";
		mes "服務人員";
		next;
		switch(select("契約?:辛苦了")) {
		case 1:
			mes "[李業]";
			mes "我所說的契約是指與我們'雷根貝勒'";
			mes "公司簽訂的傭兵契約，";
			mes "有關詳細事項及契約上通盤的";
			mes "進行方式，請詢問";
			mes "我旁邊的'狄材'小姐";
			close;
		case 2:
			mes "[李業]";
			mes "謝謝你，";
			mes "祝你有個愉快的一天";
			close;
		}
	}
	mes "你好嗎，";
	mes "請問需要幫忙嗎?";
	next;
	if(select("補償:沒事") == 2) {
		mes "[李業]";
		mes "Alright, then.";
		mes "Please do your best";
		mes "to exterminate the";
		mes "monsters that infest";
		mes "the higher floors of";
		mes "the Thanatos Tower~";
		close;
	}
	mes "[李業]";
	mes "啊...你是簽約的人啊?";
	mes "請你稍等一下";
	next;
	mes "[李業]";
	mes "你是"+strcharinfo(0)+""+(Sex?"先生":"小姐")+"啊，";
	mes "你需要哪一種物品的補償呢?";
	next;
	setarray .@Items[1],7435,7440,7441,7442;
	set .@i, select("金色手環:紅色羽毛:藍色羽毛:受詛咒的印");
	mes "[李業]";
	if (!countitem(.@Items[.@i])) {
		mes "I'm sorry, but you are not";
		mes "carrying any "+getitemname(.@Items[.@i])+"s.";
		mes "Please check your inventory";
		mes "one more time, and then come";
		mes "to me to redeem your items";
		mes "for a reward later, alright?";
		close;
	}
	mes "The reward for each";
	mes getitemname(.@Items[.@i])+" is...";
	mes " ";
	mes "1,000 zeny";
	//mes "2,000 EXP";
	next;
	set .@zeny_tt,(countitem(.@Items[.@i]) * 1000);
	//set .@exp_tt,(countitem(.@Items[.@i]) * 2000);
	mes "[李業]";
	mes countitem(.@Items[.@i])+" "+getitemname(.@Items[.@i])+"s, then";
	mes "you will receive a total of...";
	mes " ";
	mes ""+.@zeny_tt+" zeny";
	//mes ""+.@exp_tt+" EXP";
	next;
	mes "[李業]";
	mes "Would you like to exchange";
	mes "all of your "+getitemname(.@Items[.@i])+"s";
	mes "for your reward right now?";
	next;
	switch(select("Yes:No")) {
		case 1:
			mes "[李業]";
			mes "Great! Here is your";
			mes .@zeny_tt+" zeny. Thank you,";
			//mes .@exp_tt+" EXP. Thank you,";
			mes "and please keep up";
			mes "the good work~";
			delitem .@Items[.@i], countitem(.@Items[.@i]);
			set Zeny, Zeny + .@zeny_tt;
			//getexp .@exp_tt,0;
			close;
		case 2:
			mes "[李業]";
			mes "Sure, no problem.";
			mes "Just come back and";
			mes "talk to me whenever";
			mes "you want to receive";
			mes "your reward, alright?";
			close;
	}
}

tha_t02,231,161,5	script	進出 服務人員	874,{
	mes "[布魯德]";
	if (thana_tower == 0) {
		mes "這裡是通往3樓的通道，";
		mes "只有和我們簽訂契約";
		mes "行動的人，才能進出";
		next;
		mes "[布魯德]";
		mes "詳細的事項請詢問";
		mes "樓下的服務人員";
		close;
	}
	mes "This is the path to the 3rd floor.";
	mes "Only the contracted staff are allowed to enter.";
	mes "How can I help you?";
	next;
	switch(select("Let me go to 3rd floor.:Tower Information.:Start a conversation.")) {
	case 1:
		mes "[布魯德]";
		mes "Oh, alright. Let me";
		mes "check and see if you're";
		mes "on our temp list. Hmmm...";
		mes "Ah, you're "+strcharinfo(0)+", right?";
		next;
		mes "[布魯德]";
		if (getareausers("tha_t02",226,156,236,166) < 5) {
			mes "First, we need to wait until";
			mes "at least 5 temps are gathered";
			mes "to form a work group. Right";
			mes "now, there are a total of";
			mes getareausers("tha_t02",226,156,236,166)+ " temp workers waiting to";
			mes "enter the 3rd Floor.";
			next;
			mes "[布魯德]";
			mes "If you can, try to get";
			mes "your friends to help you";
			mes "by coming near me. Please";
			mes "understand that we have this";
			mes "temp worker group requirement";
			mes "for various safety reasons.";
			close;
		}
		mes "Great, you're just";
		mes "in time. We just met";
		mes "the minimum 5 temp group";
		mes "requirement, so we'll open";
		mes "the gate to the 3rd Floor soon.";
		next;
		mes "[布魯德]";
		mes "The gate to the 3rd Floor";
		mes "will close shortly, so enter it";
		mes "as soon as you can. We have";
		mes "to close it quickly because we";
		mes "can't have the tower monsters";
		mes "entering the lower floors...";
		if (thana_tower > 3) {
			next;
			mes "^4d4dffBurled is smiling lightly so that only I notice.";
			mes "I nod, then watch him open the gate.^000000";
		}
		close2;
		donpcevent "3rdf_warp#tt::OnEnable";
		end;
	case 2:
		mes "[布魯德]";
		mes "This gate is the only passage";
		mes "that connects to the 3rd Floor.";
		mes "After the 4th Floor, passages";
		mes "between floors only travel one";
		mes "way, meaning you can't exit the";
		mes "same way you that you entered.";
		next;
		mes "[布魯德]";
		mes "You see, there's a strange";
		mes "power that affects the 5th";
		mes "Floor, and all floors above,";
		mes "which doesn't allow people to";
		mes "backtrack through the passage in which they entered the floor.";
		next;
		mes "[布魯德]";
		mes "So if you ascend past the";
		mes "4th Floor, please be careful";
		mes "and make sure that you find";
		mes "a way to get back.";
		next;
		mes "[布魯德]";
		mes "The top is the 12th floor,";
		mes "and the monsters grow more powerful";
		mes "as you ascend the tower.";
		mes "The geographical features also change considerably.";
		next;
		mes "[布魯德]";
		mes "Because the higher levels are";
		mes "too dangerous, we only open the";
		mes "3rd Floor Gate when 5 or more";
		mes "are gathered here. Therefore,";
		mes "you may need to wait if less";
		mes "than 5 temps have gathered.";
		close;
	case 3:
		if (thana_tower < 3) {
			mes "[布魯德]";
			mes "...?";
			mes "Do you have any questions?";
			next;
			if(select("About the development.:The relationship of Cool Event Corporation and Rekenber Corporation.:Nope.") == 3) {
				mes "[布魯德]";
				mes "Take care.";
				close;
			}
			mes "[布魯德]";
			mes "...um, you're quite curious.";
			mes "If you want to know more, would you do me a favor?";
			mes "Since you asked for our confidential info...";
			next;
			if(select("Really? Don't make me afraid of it.:Just tell me about it.:I'll listen about it later.") == 3) {
				mes "[布魯德]";
				mes "As you wish...";
				mes "Take care!";
				close;
			}
			mes "[布魯德]";
			mes "Haha. That's not a big deal.";
			mes "We, Cool Event, are the corporation that works in many areas of business.";
			mes "From simple events, guides for dungeons, and trading items.";
			next;
			mes "[布魯德]";
			mes "Though our business started as a small one, we've been getting bigger with assistance from the Rekenber Corporation.";
			mes "They suggested to develop this tower together.";
			next;
			mes "[布魯德]";
			mes "The Rekenber Corporation is only digging out the remains for studies.";
			mes "The rest would be made into sightseeing place, which Cool Event Corporation can manage well.";
			next;
			mes "[布魯德]";
			mes "It's the biggest business ever.";
			mes "Also quite profitable as tourist attractions.";
			mes "But...";
			next;
			mes "[布魯德]";
			mes "Considerably strong monsters spawn inside the tower.";
			mes "The monsters weren't spawned there before.";
			mes "The day after that happened...";
			next;
			mes "[布魯德]";
			mes "...anyway, there were some accidently spawned monsters and some troubles...";
			mes "We and the Rekenber Corporation are in shock.";
			mes "We were influenced economically, but the more serious thing is...";
			next;
			mes "[布魯德]";
			mes "Many staff involved in development are";
			mes "sacrificing themselves by coming to 3rd floor.";
			next;
			mes "[布魯德]";
			mes "While we've pumped our all into the business, that accident happened...";
			mes "We eventually merged with the Rekenber Corporation.";
			next;
			mes "[布魯德]";
			mes "The development is on hold temporarily.";
			mes "Recruiting adventurers to defeat monsters...";
			mes "Isn't this funny?";
			next;
			mes "[布魯德]";
			mes "No matter what happened there, they wouldn't be hurt.";
			mes "Even if they don't get at the root of the accident....";
			next;
			switch(select("Oh...:What accident are you referring to?")) {
			case 1:
				mes "[布魯德]";
				mes "Yes, it's not that big of a deal. Haha....";
				mes "If we are working here like this....";
				mes "we would know about the death of animals.";
				next;
				mes "[布魯德]";
				mes "Cool Event Corporation is considered the follower...";
				mes "They don't clear up how many people";
				mes "died or any reasons for it.";
				next;
				mes "[布魯德]";
				mes "Now you're curious about this case.";
				mes "What do they sacrifice for?";
				next;
				mes "[布魯德]";
				mes "I talked a lot.";
				mes "Sorry, I am not supposed to talk about this case like this...";
				mes "I've been quite concerned about it, that's all.";
				set thana_tower, 3;
				close;
			case 2:
				mes "[布魯德]";
				mes "If you promise me that";
				mes "you will do me a favor...";
				next;
				switch(select("Ok! I will.:No, I won't.")) {
				case 1:
					callsub L_Request;
					next;
					mes "["+strcharinfo(0)+"]";
					mes "(What's the accident...?";
					mes "He might let me know later...)";
					close;
				case 2:
					mes "[布魯德]";
					mes "...there is no way...";
					mes "They request you to explore the internal part.";
					mes "You're employed for this exploration.";
					close;
				}
			}
		}
		else if (thana_tower == 3) {
			callsub L_Request;
			close;
		}
		else if (thana_tower == 4) {
			mes "[布魯德]";
			mes "Rekenber Corporation must have another intention,";
			mes "since they don't seem interested in the tower much.";
			mes "I want to know their intention.";
			next;
			mes "[布魯德]";
			mes "This tower is sealed and separated from the outside.";
			mes "We need to break those seals, explore inside and develop it.";
			next;
			mes "[布魯德]";
			mes "We are developing the 3rd and 4th floors now...";
			mes "There are still seals there.";
			mes "You can find out some clues when you search around them.";
			close;
		}
		else if ((thana_tower > 4) && (thana_tower < 9)) {
			mes "[布魯德]";
			mes "The magical key and messages?";
			mes "...we absolutely haven't learned all the tower's secrets...";
			next;
			mes "[布魯德]";
			mes "Who made the seals?";
			mes "...can you investigate more?";
			mes "There must be definitive evidence...";
			close;
		}
		else if (thana_tower == 9) {
			mes "[布魯德]";
			mes "Any new progress?";
			next;
			select("I found Varmunt's Journal...");
			mes "- You show him Varmunt's Journal.";
			mes "布魯德 reads it. -";
			next;
			mes "[布魯德]";
			mes "...I recognize this.";
			mes "This is the hologragh of the wise man Varmunt.";
			mes "Regenschirm from Rekenber's huge research institute has...";
			next;
			mes "[布魯德]";
			mes "...isn't this the one they are looking for now?!";
			mes "Isn't their mission to find out Varmunt's research materials...?";
			next;
			mes "[布魯德]";
			mes "For assisting uncompleted research...";
			mes "Varmunt's research materials are needed...";
			mes "...so their mission isn't just an investigation of the tower.";
			next;
			mes "[布魯德]";
			mes "Something to get as an advantage...";
			mes "Even they don't know where it is...";
			mes "...anyways, this is the one of their main objects.";
			next;
			mes "[布魯德]";
			mes "It's absolutely great. The wise man Varmunt's belongings. How unbelievable!";
			mes "Now, what do we do with this?";
			next;
			mes "[布魯德]";
			mes "Originally everything we found out in this tower was under control of the Rekenber Corporation.";
			mes "This is supposed to theirs, but...";
			next;
			mes "[布魯德]";
			mes "How would you like to keep this, "+strcharinfo(0)+"?";
			mes "Definitely this should be a secret.";
			mes "...um, this is a little revenge for them.";
			next;
			mes "[布魯德]";
			mes "I can guess that there are several secrets in this tower through this note.";
			mes "This secret should be disclosed by you, "+strcharinfo(0)+", before Rekenber does.";
			next;
			mes "[布魯德]";
			mes "No matter how much power they obtain... they won't get to know about this tower...";
			mes "Haha...";
			next;
			mes "[布魯德]";
			mes "...haha...";
			mes "I feel a bit relieved.";
			mes "Thanks.";
			mes "This isn't much, but here's a return present.";
			next;
			mes "[布魯德]";
			mes "I hope that these will be useful for you, "+strcharinfo(0)+".";
			next;
			mes "- 布魯德 gives you the note and an Old Violet Box. -";
			mes " ";
			mes "^4d4dffYou acquire one Old Violet Box,";
			mes "as well as a little EXP.^000000";
			set thana_tower, 10;
			completequest 7053;
			getexp 120000,10000;
			getitem 617,1; //Old_Violet_Box
			close;
		}
		else {
			mes "[布魯德]";
			mes "Are you keeping the secrets well?";
			mes "Is there a Phantom on the top of this tower?";
			if (rand(3) == 1) {
				mes "You look tired. This isn't a big deal, but it's for you.";
				npcskill "AL_HEAL",11,50,70;
			}
			close;
		}
	}

L_Request:
	mes "[布魯德]";
	mes "Ah, it's not that difficult.";
	mes "After you explore the tower, let me know in detail anything you learn.";
	next;
	mes "[布魯德]";
	mes "...I can't believe the Rekenber Corporation. Many colleagues and friends died for them.";
	mes "But the Rekenber Corporation doesn't expose the reason they are dead.";
	next;
	mes "[布魯德]";
	mes "The conditions were bad for us from beginning...";
	mes "All of the developed places except research materials would be turned into tourist attractions...";
	mes "Honestly, all the personnel are from Cool Event Corp.";
	next;
	mes "[布魯德]";
	mes "They know about it as well.";
	mes "This business needs much sacrifice as well as personnel who are up for it.";
	next;
	mes "[布魯德]";
	mes "Now I don't feel victimized anymore, but I just want to know what drives these accidents...";
	mes "^4d4dffWhat makes us victimized...?^000000";
	mes "That's what I want to know.";
	next;
	mes "[布魯德]";
	mes "What's this tower?";
	mes "Why did they develop this dangerous place?";
	mes "And for what? Should my colleagues be dead for it?";
	next;
	mes "[布魯德]";
	mes "I seriously want to know about it.";
	mes "Why they must sacrifice themselves...";
	mes "Let me know...";
	next;
	mes "He seriously wants to know about it.";
	mes "His hands are trembling now...";
	mes "I nodd without answering.";
	set thana_tower, 4;
	setquest 7048;
	return;
}

tha_t02,227,163,0	script	3rdf_warp#tt	45,1,1,{
	end;
OnInit:
	disablenpc "3rdf_warp#tt";
	end;
OnTouch:
	if (thana_tower == 0) warp "tha_t02",227,158;
	else warp "tha_t03",219,159;
	end;
OnEnable:
	enablenpc "3rdf_warp#tt";
	initnpctimer;
	end;
OnTimer30000:
	stopnpctimer;
	disablenpc "3rdf_warp#tt";
	end;
}

tha_t03,67,70,0	script	Rune Device#tt1	111,4,4,{
	if ((countitem(7421) == 0) && (countitem(7426) == 0)) {
		mes "^3355FFA mysterious field of";
		mes "energy seems to surround";
		mes "the mechanical device and";
		mes "its power prevents you from";
		mes "approaching the machine.^000000";
		next;
		switch(select("Investigate it.:I don't care about it.")) {
		case 1:
			mes "["+strcharinfo(0)+"]";
			mes "This seems mysterious...";
			mes "Let me investigate.";
			next;
			mes "^3355FFAs you follow the magical power, there's something wrapped inside the rune device.^000000";
			next;
			if (Class == Job_Taekwon) {
				mes "^3355FFYou kick the energy";
				mes "field with all of your strength. After absorbing the impact, the";
				mes "field fizzles out with a soft,";
				mes "gentle ''pzzzzzh'' sound.^000000";
				next;
				goto L_Key;
			}
			else if (getequipweaponlv(4) == 4) {
				mes "^3355FFWith your "+getequipname(4)+" in";
				mes "hand, you smash the energy";
				mes "field with all of your strength. After absorbing the impact, the";
				mes "field fizzles out with a soft,";
				mes "gentle ''pzzzzzh'' sound.^000000";
				next;
				goto L_Key;
			}
			else {
				mes "^3355FFYou smash the energy";
				mes "field with your weapon";
				mes "using all of your strength,";
				mes "but you weren't able to";
				mes "break down the barrier.";
				mes "You probably need a more";
				mes "powerful weapon...^000000";
				close;
			}
		case 2:
			mes "^3355FFYou decide to leave";
			mes "the machine alone.^000000";
			close;
		}
	}
	mes "You've acquired everything you need from this rune device.";
	close;

OnTouch:
	if ((countitem(7421) == 0) && (countitem(7426) == 0))
		specialeffect EF_LEVEL99_4;
	end;

L_Key:
	specialeffect EF_BRANDISH2;
	mes "After breaking the device, the exterior shatters.";
	mes "The energy field begins to disappear,";
	mes "and you see that a red object inside was the origin of the magical power.";
	next;
	mes "- You acquired the powerful Red Key. -";
	getitem 7421,1; //Key_Red
	if (thana_tower != 4) close;
	mes "^4d4dffOnce you hold the key, a shocking feeling passes through your head.";
	mes "You see an illusion of light...^000000";
	next;
	switch(select("Ignore it.:Concentrate on it.")) {
	case 1:
		mes "^3355FFYou decide to leave";
		mes "the machine alone.^000000";
		close;
	case 2:
		mes "You focus on the light.";
		mes "Some letters begin to appear...";
		next;
		mes "^b22222I've used the Gate Seal";
		mes "technology to seal the gate";
		mes "and the charm stones. Although";
		mes "the seals are in place, I can't";
		mes "stop worrying that they might";
		mes "break in the future.";
		next;
		mes "^b22222I can't relax when a, shall";
		mes "I say, particular group covets";
		mes "the charm stones and can easily";
		mes "break the seals. Since they are";
		mes "broken now, are many people hurt?";
		next;
		mes "^b22222This tower contains strong";
		mes "magical powers and much evil. It is";
		mes "dangerous by itself, but I sealed it";
		mes "because of one man's strong desires...";
		next;
		mes "^b22222I wouldn't recommend to go futher.";
		mes "You would need to challenge that poor";
		mes "being, who I've named this tower after.";
		mes "His soul still rests here...";
		next;
		mes "^b22222Nobody believed me, the crazy scientist.";
		mes "Though I wanted to keep this a secret, somebody";
		mes "must get to know about it. That's way I created";
		mes "this rune device, and hid this message.";
		next;
		mes "^b22222Please show that my experience";
		mes "wasn't just an illusion.^000000";
		next;
		mes "That's all.";
		mes "The letters fly away in the form of a red key...";
		set thana_tower, 5;
		changequest 7048,7049;
		specialeffect2 EF_COMBOATTACK1;
		close;
	}
}

tha_t04,195,195,0	script	Rune Device#tt2	111,3,3,{
	if ((countitem(7422) == 0) && (countitem(7427) == 0)) {
		mes "^3355FFYou find a screen";
		mes "with three tiny panels and";
		mes "a numeric keypad underneath.";
		mes "As you press one of the";
		mes "number keys, you hear a";
		mes "beep as the screen activates.^000000";
		next;
		mes "[Screen]";
		mes "Please enter a 3 digit";
		mes "number. Do not use a";
		mes "single number more than";
		mes "once or use the number 0.";
		next;
		while (1) {
			set .@yagu100, rand(1,9);
			set .@yagu10, rand(1,9);
			set .@yagu1, rand(1,9);
			if (((.@yagu100 != .@yagu10) && (.@yagu100 != .@yagu1)) && (.@yagu10 != .@yagu1))
				break;
		}
		while (1) {
			while (1) {
				input .@input;
				if (.@input < 100 || .@input > 999) {
					mes "[Screen]";
					mes "Number input";
					mes "requirement has";
					mes "not been fulfilled.";
					mes "Please enter a";
					mes "3 digit number.";
					close;
				}
				set .@input100, .@input / 100;
				set .@input10, (.@input % 100) / 10;
				if (((.@input100 > 0) && (.@input10 > 0)) && (.@input % 10 > 0)) {
					if (((.@input100 != .@input10) && (.@input100 != .@input % 10)) && (.@input10 != .@input % 10))
						break;
					mes "[Screen]";
					mes "Violation of number";
					mes "input parameter. The";
					mes "number 0 has been input,";
					mes "or a number has been";
					mes "input more than once.";
					next;
				}
			}
			set .@retry, .@retry + 1;
			mes "[Screen]";
			mes "You have input...";
			mes "^0000ff" + .@input100 + "^000000, ^0000ff" + .@input10 + "^000000, ^0000ff" + (.@input % 10) + "^000000";
			mes " ";
			mes "Calculating Results...";
			mes "Please wait a moment...";
			next;
			set .@strike, 0;
			set .@ball, 0;
			if (.@yagu100 == .@input100) set .@strike, .@strike + 1;
			if (.@yagu10 == .@input10) set .@strike, .@strike + 1;
			if (.@yagu1 == .@input % 10) set .@strike, .@strike + 1;
			if ((.@yagu100 == .@input10) || (.@yagu100 == .@input % 10)) set .@ball, .@ball + 1;
			if ((.@yagu10 == .@input100) || (.@yagu10 == .@input % 10)) set .@ball, .@ball + 1;
			if ((.@yagu1 == .@input100) || (.@yagu1 == .@input10)) set .@ball, .@ball + 1;
			if (.@strike == 3) {
				mes "[Screen]";
				mes "Input number accepted.";
				mes "Access authorized.";
				next;
				mes "^3355FFAfter the screen displays";
				mes "the access authorization";
				mes "notice, magical power condenses";
				mes "and appears on the screen's";
				mes "surface. An object forms...^000000";
				next;
				mes "^4d4dffThe powerful Yellow Key appears.^000000";
				getitem 7422,1; //Key_Yellow
				if (thana_tower != 5) close;
				mes "^4d4dffA fierce feeling passes through your head.";
				mes "You seen an illusion of light, like when you acquired the first key.^000000";
				next;
				switch(select("Ignore it.:Concentrate on it.")) {
				case 1:
					mes "You decide to ignore it.";
					close;
				case 2:
					mes "You focus on the light.";
					mes "Some letters begin to appear...";
					next;
					mes "^b22222Have you found the second key?";
					mes "I wish to tell you where the seal is, but I won't unveil it so easily.";
					mes "Here's a hint. Go to the eagle on the 5th floor.";
					next;
					mes "^b22222The reason I came here is...";
					mes "to find someone.";
					mes "We human beings can't understand this...";
					next;
					mes "^b22222When I found her in Juperos, I couldn't relax.";
					mes "The giant men staying with her in deep side of cave";
					mes "made me rush through my investigation...";
					next;
					mes "^b22222After confirming her existence, I became blindly obsessed with finding traces of her.";
					mes "'Her', you ask? She is shaped like a woman...";
					next;
					mes "^b22222I followed her traces without knowing that she existed 10 years earlier.";
					mes "Then I came upon this place.";
					next;
					mes "^b22222This tower set up for...^000000";
					next;
					mes "It suddenly shakes, then disappears.";
					set thana_tower, 6;
					changequest 7049,7050;
					specialeffect2 EF_COMBOATTACK1;
					close;
				}
			}
			else {
				mes "[Screen]";
				mes "*Beeeeep*";
				mes "Unauthorized";
				mes "numerical sequence.";
				next;
				mes "[Screen]";
				mes "Correct number";
				mes "in correct place";
				mes "in sequence total: ^FF0000" + .@strike + "^000000";
				mes " ";
				mes "Correct number total: ^FF0000" + .@ball + "^000000";
				next;
				if (.@retry > 4) {
					mes "[Screen]";
					mes "Correct number";
					mes "authorization";
					mes "sequence was...";
					mes "^ff0000" + .@yagu100 + "^000000, ^ff0000" + .@yagu10 + "^000000, ^ff0000" + .@yagu1 + "^000000";
					mes "Authorization number";
					mes "will change upon retry.";
					close;
				}
			}
		}
	}
	mes "You've acquired everything you need from this rune device.";
	close;

OnTouch:
	if ((countitem(7422) == 0) && (countitem(7427) == 0))
		specialeffect EF_LEVEL99_4;
	end;
}

tha_t05,62,179,0	script	Brilliant Statue#tt3	111,3,3,{
	if ((countitem(7423) == 0) && (countitem(7428) == 0)) {
		mes "I can feel some magical power from this beautiful stone statue.";
		mes "There's a little crack between the wings.";
		next;
		mes "Red light is shining on a crack in the left wing, and gold light on a crack in the right one.";
		mes "What will you do?";
		next;
		if(select("Stick the key into the crack...:Ignore it.") == 2) {
			mes "^3355FFYou decide to leave";
			mes "the statue alone.^000000";
			close;
		}
		if ((countitem(7421) > 0) && (countitem(7422) > 0)) {
			mes "["+strcharinfo(0)+"]";
			mes "I'll try the left wing first.";
			mes "What key should I put in?";
			next;
			input .@inputstr$;
			if ((.@inputstr$ != "Red Key") && (.@inputstr$ != "red key")) {
				mes "It doesn't fit into the crack.";
				close;
			}
			mes "The key fits and makes a click.";
			mes "You feel the magical power growing stronger...";
			next;
			mes "["+strcharinfo(0)+"]";
			mes "Now the right side...";
			next;
			input .@inputstr$;
			if ((.@inputstr$ != "Yellow Key") && (.@inputstr$ != "yellow key")) {
				mes "It doesn't fit into the crack.";
				close;
			}
			mes "The key fits and makes a click.";
			mes "The beak of the bird suddenly opens, and a strong light comes out.";
			mes "There's a key-shaped object inside...";
			next;
			mes "^4d4dffThe powerful Blue Key appears.^000000";
			getitem 7423,1; //Key_Blue
			if (thana_tower != 6) close;
			mes "^4d4dffOnce you hold the key, a shocking feeling passes through your head.";
			mes "You see an illusion of light...^000000";
			next;
			switch(select("Concentrate on it.:Ignore it.")) {
			case 1:
				mes "This part isn't as clear as before.";
				mes "You try to figure out what it's saying...";
				next;
				mes "^b22222...this tower was built by a magical tribe, not by human beings.";
				mes "This was quite interesting to me...";
				mes "I started to investigate why they built up the tower...";
				next;
				mes "^b22222I found out that this tower was a gate for the magic tribe";
				mes "during a millennium war.^000000";
				next;
				mes ".........It's not clearly shown......";
				mes "^b22222...Morroc has gone through this gate";
				mes "from the magical world into the Midgard continent after the millennium war terminated...";
				next;
				mes "^b22222The question is that when she come up here, the Satan appears at the same time...";
				mes "The truth is..........^000000";
				next;
				mes "The illusion shakes, then melts on the surface of the key as light.";
				set thana_tower, 7;
				changequest 7050,7051;
				specialeffect2 EF_COMBOATTACK1;
				close;
			case 2:
				mes "You decide to ignore it.";
				close;
			}
		}
		mes "You try to fit something in the crack, but to no avail.";
		close;
	}
	mes "You've acquired everything you need from this statue.";
	close;

OnTouch:
	if ((countitem(7423) == 0) && (countitem(7428) == 0))
		specialeffect EF_LEVEL99_4;
	end;
}

tha_t06,226,230,0	script	Brilliant Statue#tt4	111,3,3,{
	if ((countitem(7424) == 0) && (countitem(7429) == 0)) {
		mes "I can feel some magical power from this brilliant statue.";
		mes "This must be one of the seals.";
		next;
		mes "You see a floating round object with a hole in it.";
		mes "There're red, yellow, and blue light in a row.";
		mes "What will you do?";
		next;
		if(select("Investigate.:Ignore it.") == 2) {
			mes "^3355FFYou don't see the need to";
			mes "investigate if nothing seems";
			mes "peculiar or out of place...^000000";
			close;
		}
		if ((countitem(7421) > 0) && (countitem(7422) > 0) && (countitem(7423) > 0)) {
			mes "When you insert the key into the keyhole of the ornament";
			mes "and match them by corresponding color, the Stone Statue will snap open.";
			mes "You can see small wheels are moving inside.";
			next;
			switch(select("Investigate the Machine Chasis:Investigate the Wheels:Cancel")) {
			case 1:
				mes "^3355FFThe key in your inventory";
				mes "does not seem to be affecting";
				mes "the machine's chasis. The";
				mes "screen mounted on the side";
				mes "is still blank and deactivated.^000000";
				close;
			case 2:
				set .@small_1, 0;
				set .@small_2, 0;
				set .@big_1, 0;
				set .@big_2, 0;
				set .@big_3, 0;
				mes "^3355FFYou touch the wheels and";
				mes "find that they are actually";
				mes "moving very slowly. You note";
				mes "that there are 2 small wheels";
				mes "and 3 larger wheels, totaling";
				mes "5 wheels on this machine.^000000";
				next;
				mes "^3355FFThe big wheels are moving";
				mes "vertically, up and down, as";
				mes "they press against the smaller";
				mes "wheels to make them rotate.^000000";
				next;
				mes "^3355FFJudging from the machine's";
				mes "shaking and jittery noises, the";
				mes "wheels may be misaligned.";
				mes "You might be able to activate";
				mes "the machine by properly ";
				mes "aligning all the wheels.^000000";
				while (1) {
					next;
					mes "^3355FFWhich wheel do";
					mes "you want to shift?^000000";
					switch(select("1st Small Wheel:2nd Small Wheel:1st Big Wheel:2nd Big Wheel:3rd Big Wheel:Check Current Wheel Configuration:Reset Wheels to Default Configuration")) {
					case 1:
						switch(select("Raise Wheel:Lower Wheel:Press Wheel")) {
						case 1:
							mes "^EE0000*Choom*^000000";
							set .@small_1, 2;
							if ((.@small_1 == 2) && (.@small_2 == 2) && (.@big_1 == 2) && (.@big_2 == 2) && (.@big_3 == 2)) break;
							continue;
						case 2:
							mes "^00B2EE*Sneeeep*^000000";
							set .@small_1, 1;
							if ((.@small_1 == 1) && (.@small_2 == 1) && (.@big_1 == 1) && (.@big_2 == 1) && (.@big_3 == 1)) break;
							continue;
						case 3:
							mes "^5C246E*Mrreeem*^000000";
							set .@small_1, 3;
							if ((.@small_1 == 3) && (.@small_2 == 3) && (.@big_1 == 3) && (.@big_2 == 3) && (.@big_3 == 3)) break;
							continue;
						}
						break;
					case 2:
						switch(select("Raise Wheel:Lower Wheel:Press Wheel")) {
						case 1:
							mes "^5C246E*Mrreeem*^000000";
							set .@small_2, 3;
							if ((.@small_1 == 3) && (.@small_2 == 3) && (.@big_1 == 3) && (.@big_2 == 3) && (.@big_3 == 3)) break;
							continue;
						case 2:
							mes "^EE0000*Choom*^000000";
							set .@small_2, 2;
							if ((.@small_1 == 2) && (.@small_2 == 2) && (.@big_1 == 2) && (.@big_2 == 2) && (.@big_3 == 2)) break;
							continue;
						case 3:
							mes "^00B2EE*Sneeeep*^000000";
							set .@small_2, 1;
							if ((.@small_1 == 1) && (.@small_2 == 1) && (.@big_1 == 1) && (.@big_2 == 1) && (.@big_3 == 1)) break;
							continue;
						}
						break;
					case 3:
						switch(select("Raise Wheel:Lower Wheel:Vertically Shift Wheel")) {
						case 1:
							mes "^00B2EE*Sneeeep*^000000";
							set .@big_1, 1;
							if ((.@small_1 == 1) && (.@small_2 == 1) && (.@big_1 == 1) && (.@big_2 == 1) && (.@big_3 == 1)) break;
							continue;
						case 2:
							mes "^5C246E*Mrreeem*^000000";
							set .@big_1, 3;
							if ((.@small_1 == 3) && (.@small_2 == 3) && (.@big_1 == 3) && (.@big_2 == 3) && (.@big_3 == 3)) break;
							continue;
						case 3:
							mes "^EE0000*Choom*^000000";
							set .@big_1, 2;
							if ((.@small_1 == 2) && (.@small_2 == 2) && (.@big_1 == 2) && (.@big_2 == 2) && (.@big_3 == 2)) break;
							continue;
						}
						break;
					case 4:
						switch(select("Raise Wheel:Lower Wheel:Vertically Shift Wheel")) {
						case 1:
							mes "^EE0000*Choom*^000000";
							set .@big_2, 2;
							if ((.@small_1 == 2) && (.@small_2 == 2) && (.@big_1 == 2) && (.@big_2 == 2) && (.@big_3 == 2)) break;
							continue;
						case 2:
							mes "^5C246E*Mrreeem*^000000";
							set .@big_2, 3;
							if ((.@small_1 == 3) && (.@small_2 == 3) && (.@big_1 == 3) && (.@big_2 == 3) && (.@big_3 == 3)) break;
							continue;
						case 3:
							mes "^00B2EE*Sneeeep*^000000";
							set .@big_2, 1;
							if ((.@small_1 == 1) && (.@small_2 == 1) && (.@big_1 == 1) && (.@big_2 == 1) && (.@big_3 == 1)) break;
							continue;
						}
						break;
					case 5:
						switch(select("Raise Wheel:Lower Wheel:Vertically Shift Wheel")) {
						case 1:
							mes "^EE0000*Choom*^000000";
							set .@big_3, 2;
							if ((.@small_1 == 2) && (.@small_2 == 2) && (.@big_1 == 2) && (.@big_2 == 2) && (.@big_3 == 2)) break;
							continue;
						case 2:
							mes "^00B2EE*Sneeeep*^000000";
							set .@big_3, 1;
							if ((.@small_1 == 1) && (.@small_2 == 1) && (.@big_1 == 1) && (.@big_2 == 1) && (.@big_3 == 1)) break;
							continue;
						case 3:
							mes "^5C246E*Mrreeem*^000000";
							set .@big_3, 3;
							if ((.@small_1 == 3) && (.@small_2 == 3) && (.@big_1 == 3) && (.@big_2 == 3) && (.@big_3 == 3)) break;
							continue;
						}
						break;
					case 6:
						if (.@small_1 == 0) mes "1st Small Wheel: No Change";
						else if (.@small_1 == 1) mes "1st Small Wheel: Down";
						else if (.@small_1 == 2) mes "1st Small Wheel: Up";
						else mes "1st Small Wheel: Pressed";

						if (.@small_2 == 0) mes "2nd Small Wheel: No Change";
						else if (.@small_2 == 1) mes "2nd Small Wheel: Pressed";
						else if (.@small_2 == 2) mes "2nd Small Wheel: Down";
						else mes "2nd Small Wheel: Up";

						if (.@big_1 == 0) mes "1st Big Wheel: No Change";
						else if (.@big_1 == 1) mes "1st Big Wheel: Up";
						else if (.@big_1 == 2) mes "1st Big Wheel: Moved";
						else mes "1st Big Wheel: Down";

						if (.@big_2 == 0) mes "2nd Big Wheel: No Change";
						else if (.@big_2 == 1) mes "2nd Big Wheel: Moved";
						else if (.@big_2 == 2) mes "2nd Big Wheel: Up";
						else mes "2nd Big Wheel: Down";

						if (.@big_3 == 0) mes "3rd Big Wheel: No Change";
						else if (.@big_3 == 1) mes "3rd Big Wheel: Down";
						else if (.@big_3 == 2) mes "3rd Big Wheel: Up";
						else mes "3rd Big Wheel: Moved";
						continue;
					case 7:
						set .@small_1, 0;
						set .@small_2, 0;
						set .@big_1, 0;
						set .@big_2, 0;
						set .@big_3, 0;
						continue;
					}
					break;
				}
				mes "As you adjust the wheels,";
				mes "they suddenly activate";
				mes "with a firm click.";
				next;
				mes "A part of the ornament in the stone statue starts to spin,";
				mes "and a shining light beam climbs up the elegant statue.";
				mes "A strong cursed power emerges and emits a dazzling green light.";
				specialeffect EF_DISPELL;
				specialeffect EF_POTION6;
				next;
				mes "^4d4dffAll of a sudden, the Green Key appears and you can feel great power from it.^000000";
				getitem 7424,1; //Key_Green
				if (thana_tower != 7) close;
				mes "^4d4dffWhen you pick up the key,";
				mes "your body trembles";
				mes "with an unknown power";
				mes "and you see a hallucination with some text.^000000";
				next;
				switch(select("Concentrate on it.:Ignore it.")) {
				case 1:
					mes "^b22222...You found 4 keys";
					mes "and finally released 4 spells...";
					mes "This tower used to be";
					mes "a gate to summon demons ages ago.";
					mes "And the last visitor was";
					mes "the infamous Satan Morroc.";
					next;
					mes "^b22222As I followed her trail";
					mes "I realized that her spells";
					mes "were scattered around the tower.";
					mes "Then, somehow, it vanished into the ground.";
					next;
					mes "^b22222The great battle and";
					mes "the protracted war...";
					mes "But her purpose was...";
					mes "that... sealing of the gate...";
					mes "so... I tried to seal...";
					mes "but it was incomplete...";
					mes "the guard of the gate was...^000000";
					next;
					mes "["+strcharinfo(0)+"]";
					mes "It is hard to read.";
					next;
					mes "^b22222...So I changed the location";
					mes "of the coupling spot...";
					mes "I mean, push through to the tower";
					mes "to tangle it...";
					mes "Anyway, I wanted to respect";
					mes "her loyalty and block the gate...";
					next;
					mes "^b22222If I want to... then I have to";
					mes "release the last spell...";
					mes "He finally came to meet...";
					mes "with his pieces...";
					mes "...and then...^000000";
					next;
					mes "The hallucination wobbles";
					mes "and fades into the key.";
					set thana_tower, 8;
					changequest 7051,7052;
					specialeffect2 EF_BEGINSPELL6;
					specialeffect2 EF_SPELLBREAKER;
					close;
				case 2:
					mes "It was too intense to see the hallucination, so you gave up reading.";
					close;
				}
			case 3:
				mes "You decide to ignore it.";
				close;
			}
		}
		mes "You don't have the right key for this keyhole.";
		close;
	}
	mes "The spell is already released. You've acquired everything you need from this statue.";
	close;

OnTouch:
	if ((countitem(7424) == 0) && (countitem(7429) == 0))
		specialeffect EF_LEVEL99_4;
	end;
}

tha_t06,204,181,0	script	Splendid Sword#tt5	111,3,3,{
	if ((countitem(7425) == 0) && (countitem(7430) == 0)) {
		mes "An old, worn sword hangs above the splendid table.";
		mes "It emits a gloomy aura.";
		next;
		if ((countitem(7421) > 0) && (countitem(7422) > 0) && (countitem(7423) > 0) && (countitem(7424) > 0)) {
			mes "As you approach, the keys in your pocket";
			mes "suddenly respond with a mysterious power.";
			specialeffect2 EF_ABSORBSPIRITS;
			next;
			if(select("Observe it.:Ignore it.") == 2) {
				mes "^3355FFYou decide to leave";
				mes "the sword alone.^000000";
				close;
			}
			mes "While you get closer and closer, the sword shakes with a loud noise.";
			mes "Your eyes keep getting drawn to the sword's hilt.";
			mes "Then you lose control of your hands, and they stretch forth to grasp the handle...";
			next;
			switch(select("Towards the blade of the sword:Towards the hilt of the sword:Towards the table")) {
			case 1:
				mes "By an unknown calling you decide to grab the blade of the sword.";
				mes "Your hands get wounded and begin to bleed.";
				specialeffect2 EF_HIT1;
				percentheal -20,0;
				close;
			case 2:
				mes "By an unknown calling you decide to grab the hilt of the sword.";
				mes "The mysterious power from the keys transfers to the sword, and it falls from the table.";
				next;
				mes "At the same time, a little hole appears on the table's surface.";
				mes "Now, you hold the sword and...";
				specialeffect EF_EXIT2;
				next;
				switch(select("Strike the table:Insert the sword into the hole:Bring the sword safely")) {
				case 1:
					mes "You strike the table with the sword.";
					mes "Numerous conflicting spells act upon it, and you can tell that you chose incorrectly.";
					mes "The sword automatically returns to the table, as it was before.";
					specialeffect EF_HIT1;
					specialeffect2 EF_HIT1;
					percentheal -20,0;
					close;
				case 2:
					mes "As you insert the sword, lightning flashes around it and black smoke rises from the hole.";
					mes "Slowly the smoke clears, and you see an object with a certain shape...";
					specialeffect EF_CHANGEDARK;
					next;
					mes "^4d4dff All of a sudden, a Black Key appears from the smoke and you feel a great cursed power from it.^000000";
					getitem 7425,1; //Key_Black
					if (thana_tower != 8) close;
					next;
					mes "A drawer had snapped open under the table while you picked up the key and observed it.";
					mes "You can see an old notebook inside the drawer.";
					next;
					mes "The notebook definitely looks like it contains an important message.";
					mes "Maybe this notebook is the one that Rekenber wants to find, even with all the sacrifices.";
					next;
					mes "^4d4dffYou decide to show the notebook and the keys to 布魯德.";
					mes "You received Varmunt's Journal.^000000";
					set thana_tower, 9;
					changequest 7052,7053;
					getitem 11011,1; //Barmund_Note
					close;
				case 3:
					mes "When you lift the sword, you feel a shock from numerous conflicting spells.";
					mes "Right... stealing is the worst.";
					mes "The sword automatically returns to the table, as it was before.";
					close;
				}
			case 3:
				mes "You stretch your hands to find something under the table, but there is nothing.";
				close;
			}
		}
		mes "You strongly feel a cursed, sealed power from here,";
		mes "but it is hard to figure out what is causing it.";
		mes "You cannot approach it.";
		close;
	}
	mes "You have already released a seal using this sword.";
	mes "You've acquired everything you need from here.";
	close;

OnTouch:
	if ((countitem(7425) == 0) && (countitem(7430) == 0))
		specialeffect EF_LEVEL99_4;
	end;
}

tha_t08,1,1,0	script	#Charm Stone Admintt01	844,{
	end;
OnInit:
OnEnable:
	initnpctimer;
	end;
OnTimer1000:
	donpcevent "Shining Crystal#tt_r1::OnEnable";
	donpcevent "Shining Crystal#tt_g1::OnEnable";
	donpcevent "Shining Crystal#tt_b1::OnEnable";
	donpcevent "Shining Crystal#tt_y1::OnEnable";
	end;
OnTimer600000:
	donpcevent "Shining Crystal#tt_r1::OnDisable";
	donpcevent "Shining Crystal#tt_g1::OnDisable";
	donpcevent "Shining Crystal#tt_b1::OnDisable";
	donpcevent "Shining Crystal#tt_y1::OnDisable";
	donpcevent "Shining Crystal#tt_r2::OnEnable";
	donpcevent "Shining Crystal#tt_g2::OnEnable";
	donpcevent "Shining Crystal#tt_b2::OnEnable";
	donpcevent "Shining Crystal#tt_y2::OnEnable";
	end;
OnTimer1200000:
	donpcevent "Shining Crystal#tt_r2::OnDisable";
	donpcevent "Shining Crystal#tt_g2::OnDisable";
	donpcevent "Shining Crystal#tt_b2::OnDisable";
	donpcevent "Shining Crystal#tt_y2::OnDisable";
	donpcevent "Shining Crystal#tt_r3::OnEnable";
	donpcevent "Shining Crystal#tt_g3::OnEnable";
	donpcevent "Shining Crystal#tt_b3::OnEnable";
	donpcevent "Shining Crystal#tt_y3::OnEnable";
	end;
OnTimer1800000:
	donpcevent "Shining Crystal#tt_r3::OnDisable";
	donpcevent "Shining Crystal#tt_g3::OnDisable";
	donpcevent "Shining Crystal#tt_b3::OnDisable";
	donpcevent "Shining Crystal#tt_y3::OnDisable";
	donpcevent "Shining Crystal#tt_r4::OnEnable";
	donpcevent "Shining Crystal#tt_g4::OnEnable";
	donpcevent "Shining Crystal#tt_b4::OnEnable";
	donpcevent "Shining Crystal#tt_y4::OnEnable";
	end;
OnTimer2400000:
	donpcevent "Shining Crystal#tt_r4::OnDisable";
	donpcevent "Shining Crystal#tt_g4::OnDisable";
	donpcevent "Shining Crystal#tt_b4::OnDisable";
	donpcevent "Shining Crystal#tt_y4::OnDisable";
	donpcevent "#Charm Stone Admintt01::OnEnable";
	end;
}

tha_t08,90,153,0	script	Shining Crystal#tt_r1	844,{
	if (countitem(7421) > 0) {
		mes "The Crystal ball is emitting mysterious power.";
		next;
		mes "Beside the crystal ball, you find faded patterns marked on the floor.";
		mes "Looks like some kind of keyhole that needs to be inserted with something...";
		next;
		mes "The red key suddenly responds once you come close to the keyhole.";
		mes "You insert the key in the keyhole and it turns out to be a small gem.";
		next;
		mes "When you touch the gem which is dazzling red...";
		mes "You feel isolated and depressed deep inside your heart...";
		next;
		mes "^4d4dffYou have found a Red Charm Stone that is concentrated with cruel fate and a deep darkness.^000000";
		delitem 7421,1; //Key_Red
		getitem 7426,1; //Magic_Gem_Red
		close;
	}
	mes "The Crystal ball is emitting mysterious power.";
	mes "Something is definitely there inside... How do I get it to open?";
	close;

OnInit:
OnDisable:
	disablenpc strnpcinfo(0);
	end;
OnEnable:
	enablenpc strnpcinfo(0);
	end;
}
tha_t08,90,62,0	duplicate(Shining Crystal#tt_r1)	Shining Crystal#tt_r2	844
tha_t08,49,59,0	duplicate(Shining Crystal#tt_r1)	Shining Crystal#tt_r3	844
tha_t08,49,144,0	duplicate(Shining Crystal#tt_r1)	Shining Crystal#tt_r4	844

tha_t08,49,153,0	script	Shining Crystal#tt_y1	844,{
	if (countitem(7422) > 0) {
		mes "The Crystal ball is emitting mysterious power.";
		next;
		mes "Beside the crystal ball, you find faded patterns marked on the floor.";
		mes "Looks like some kind of keyhole that needs to be inserted with something...";
		next;
		mes "The yellow key suddenly responds once you come close to the keyhole.";
		mes "You insert the key in the keyhole and it turns out to be a small gem.";
		next;
		mes "When you touch the gem which is dazzling yellow...";
		mes "Your heart begins to throb as though you are suffering from a broken heart.";
		next;
		mes "^4d4dffYou have found a Yellow Charm Stone that is concentrated with grief and mysterious power.^000000";
		delitem 7422,1; //Key_Yellow
		getitem 7427,1; //Magic_Gem_Yellow
		close;
	}
	mes "The Crystal ball is emitting mysterious power.";
	mes "Something is definitely there inside... How do I get it to open?";
	close;

OnInit:
OnDisable:
	disablenpc strnpcinfo(0);
	end;
OnEnable:
	enablenpc strnpcinfo(0);
	end;
}
tha_t08,90,150,0	duplicate(Shining Crystal#tt_y1)	Shining Crystal#tt_y2	844
tha_t08,90,59,0	duplicate(Shining Crystal#tt_y1)	Shining Crystal#tt_y3	844
tha_t08,49,56,0	duplicate(Shining Crystal#tt_y1)	Shining Crystal#tt_y4	844

tha_t08,49,65,0	script	Shining Crystal#tt_b1	844,{
	if (countitem(7423) > 0) {
		mes "The Crystal ball is emitting mysterious power.";
		next;
		mes "Beside the crystal ball, you find faded patterns marked on the floor.";
		mes "Looks like some kind of keyhole that needs to be inserted with something...";
		next;
		mes "The blue key suddenly responds once you come close to the keyhole.";
		mes "You insert the key in the keyhole and it turns out to be a small gem.";
		next;
		mes "When you touch the gem which is dazzling blue....";
		mes "Someone's sobbing comes into your ears as you smell blood on the wind and suddenly you become angry.";
		next;
		mes "^4d4dffYou have found a Blue Charm Stone that is concentrated with grudge and mysterious power.^000000";
		delitem 7423,1; //Key_Blue
		getitem 7428,1; //Magic_Gem_Blue
		close;
	}
	mes "The Crystal ball is emitting mysterious power.";
	mes "Something is definitely there inside... How do I get it to open?";
	close;

OnInit:
OnDisable:
	disablenpc strnpcinfo(0);
	end;
OnEnable:
	enablenpc strnpcinfo(0);
	end;
}
tha_t08,49,150,0	duplicate(Shining Crystal#tt_b1)	Shining Crystal#tt_b2	844
tha_t08,90,147,0	duplicate(Shining Crystal#tt_b1)	Shining Crystal#tt_b3	844
tha_t08,90,56,0	duplicate(Shining Crystal#tt_b1)	Shining Crystal#tt_b4	844

tha_t08,90,65,0	script	Shining Crystal#tt_g1	844,{
	if (countitem(7424) > 0) {
		mes "The Crystal ball is emitting mysterious power.";
		next;
		mes "Beside the crystal ball, you find faded patterns marked on the floor.";
		mes "Looks like some kind of keyhole that needs to be inserted with something...";
		next;
		mes "The green key suddenly responds once you come close to the keyhole.";
		mes "You insert the key in the keyhole and it turns out to be a small gem.";
		next;
		mes "When you touch the gem which is dazzling green...";
		mes "Your head starts to ache and you feel worried and anxious about something.";
		next;
		mes "^4d4dffYou have found a Green Charm Stone that is concentrated with deep suffering.^000000";
		delitem 7424,1; //Key_Green
		getitem 7429,1; //Magic_Gem_Green
		close;
	}
	mes "The Crystal ball is emitting mysterious power.";
	mes "Something is definitely there inside... How do I get it to open?";
	close;

OnInit:
OnDisable:
	disablenpc strnpcinfo(0);
	end;
OnEnable:
	enablenpc strnpcinfo(0);
	end;
}
tha_t08,49,62,0	duplicate(Shining Crystal#tt_g1)	Shining Crystal#tt_g2	844
tha_t08,49,147,0	duplicate(Shining Crystal#tt_g1)	Shining Crystal#tt_g3	844
tha_t08,90,144,0	duplicate(Shining Crystal#tt_g1)	Shining Crystal#tt_g4	844

tha_t12,161,57,0	script	Gold Religious Statue#tt	111,{
	if ($@thana_summon == 0) {
		if (countitem(7427) > 0) {
			mes "It's a statue giving off a golden light.";
			mes "The sword appears to be missing a gem.";
			mes "As I draw closer to the statue, the Yellow Charm Stone emits a bright light.";
			specialeffect EF_BEGINSPELL5;
			specialeffect2 EF_BEGINSPELL5;
			next;
			if(select("Insert the Yellow Charm Stone.:Run away.") == 2) close;
			if ($@thana_summon == 0) {
				mes "After inserting the Yellow Charm Stone into the sword, the statue begins to react.";
				specialeffect EF_BEGINSPELL5;
				delitem 7427,1; //Magic_Gem_Yellow
				set $@thana_summon, 1;
				donpcevent "#tteffect01::OnEnable";
				mapannounce "tha_t12","The golden magic power has released part of the seal.",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
				close;
			}
			mes "Someone has already inserted a Charm Stone into this statue.";
			close;
		}
		mes "The statue give off mysterious light.";
		mes "Strange power has blocked your access.";
		close;
	}
	mes "The statue has such a strong light that I can't see or touch it.";
	close;
}

tha_t12,154,17,0	script	Green Wiseman Statue#tt	111,{
	if ($@thana_summon == 1) {
		if (countitem(7429) > 0) {
			mes "A statue gives off green light.";
			mes "The wiseman's wand seems to be missing a gem.";
			mes "As I draw closer to the statue, the Green Charm Stone emits a bright light.";
			specialeffect EF_BEGINSPELL4;
			specialeffect2 EF_BEGINSPELL4;
			next;
			if(select("Insert the Green Charm Stone.:Run away.") == 2) close;
			if ($@thana_summon == 1) {
				mes "After inserting the Green Charm Stone into the wand, the statue begins to react.";
				specialeffect EF_BEGINSPELL4;
				delitem 7429,1; //Magic_Gem_Green
				set $@thana_summon, 2;
				donpcevent "#tteffect02::OnEnable";
				mapannounce "tha_t12","The green magic power has released part of the seal.",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
				close;
			}
			mes "Someone has already inserted a Charm Stone into this statue.";
			close;
		}
		mes "The statue give off mysterious light.";
		mes "Strange power has blocked your access.";
		close;
	}
	mes "The statue has such a strong light that I can't see or touch it.";
	close;
}

tha_t12,103,17,0	script	Blue Angel Statue#tt	111,{
	if ($@thana_summon == 2) {
		if (countitem(7428) > 0) {
			mes "An angel statue is covered with a blue light.";
			mes "A gem seems to be missing from the statue's belt.";
			mes "As I draw closer to the statue, the Blue Charm Stone emits a bright light.";
			specialeffect EF_BEGINSPELL2;
			specialeffect2 EF_BEGINSPELL2;
			next;
			if(select("Insert the Blue Charm Stone.:Run away.") == 2) close;
			if ($@thana_summon == 2) {
				mes "After inserting the Blue Charm Stone into the belt, the statue begins to react.";
				specialeffect EF_BEGINSPELL2;
				delitem 7428,1; //Magic_Gem_Blue
				set $@thana_summon, 3;
				donpcevent "#tteffect03::OnEnable";
				mapannounce "tha_t12","The blue magic power has released part of the seal.",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
				close;
			}
			mes "Someone has already inserted a Charm Stone into this statue.";
			close;
		}
		mes "The statue give off mysterious light.";
		mes "Strange power has blocked you to access.";
		close;
	}
	mes "The statue has such a strong light that I can't see or touch it.";
	close;
}

tha_t12,96,57,0	script	Bloody Knight Statue#tt	111,{
	if ($@thana_summon == 3) {
		if (countitem(7426) > 0) {
			mes "A statue is shining like blood.";
			mes "A gem seems to be missing from the heart area of its armor.";
			mes "As I draw closer to the statue, the Red Charm Stone emits a bright light.";
			specialeffect EF_BEGINSPELL3;
			specialeffect2 EF_BEGINSPELL3;
			next;
			if(select("Insert the Red Charm Stone.:Run away.") == 2) close;
			if ($@thana_summon == 3) {
				mes "After inserting the Red Charm Stone into the armor, the statue begins to react.";
				specialeffect EF_BEGINSPELL3;
				delitem 7426,1; //Magic_Gem_Red
				set $@thana_summon, 4;
				donpcevent "#tteffect04::OnEnable";
				mapannounce "tha_t12","The red magic power has released part of the seal.",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
				close;
			}
			mes "Someone has already inserted a Charm Stone into this statue.";
			close;
		}
		mes "The statue give off mysterious light.";
		mes "Strange power has blocked you to access.";
		close;
	}
	mes "The statue has such a strong light that I can't see or touch it.";
	close;
}

tha_t12,129,86,0	script	Dark Devil Statue#tt	111,{
	if ($@thana_summon == 4) {
		if (countitem(7430) > 0) {
			mes "A devil statue emits dark light.";
			mes "The right eye seems to be missing a gem.";
			mes "As I draw closer to the statue, the Black Charm Stone emits a bright light.";
			specialeffect EF_BEGINSPELL7;
			specialeffect2 EF_BEGINSPELL7;
			next;
			if(select("Insert the Black Charm Stone.:Run away.") == 2) close;
			if ($@thana_summon == 4) {
				mes "After inserting the Red Charm Stone into the eye socket, the statue begins to react.";
				specialeffect EF_BEGINSPELL7;
				delitem 7430,1; //Magic_Gem_Black
				set $@thana_summon, 5;
				donpcevent "#gateto_thanatos::OnEnable";
				donpcevent "#tteffect01::OnStop";
				donpcevent "#tteffect02::OnStop";
				donpcevent "#tteffect03::OnStop";
				donpcevent "#tteffect04::OnStop";
				mapannounce "tha_t12","The Black Charm Stone's magic power has released the final seal.",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
				close;
			}
			mes "Someone has already inserted a Charm Stone into this statue.";
			close;
		}
		mes "The statue give off mysterious light.";
		mes "Strange power has blocked you to access.";
		close;
	}
	mes "The statue has such a strong light that I can't see or touch it.";
	close;
}

tha_t12,134,52,0	script	#tteffect01	139,{
	end;
OnEnable:
	initnpctimer;
	end;
OnStop:
	stopnpctimer;
	end;
OnTimer500:
OnTimer1000:
OnTimer1500:
OnTimer2000:
OnTimer2500:
	specialeffect EF_BEGINSPELL5;
	end;
OnTimer3000:
	donpcevent "#tteffect01::OnEnable";
	end;
}

tha_t12,132,47,0	script	#tteffect02	139,{
	end;
OnEnable:
	initnpctimer;
	end;
OnStop:
	stopnpctimer;
	end;
OnTimer500:
OnTimer1000:
OnTimer1500:
OnTimer2000:
OnTimer2500:
	specialeffect EF_BEGINSPELL4;
	end;
OnTimer3000:
	donpcevent "#tteffect02::OnEnable";
	end;
}

tha_t12,127,47,0	script	#tteffect03	139,{
	end;
OnEnable:
	initnpctimer;
	end;
OnStop:
	stopnpctimer;
	end;
OnTimer500:
OnTimer1000:
OnTimer1500:
OnTimer2000:
OnTimer2500:
	specialeffect EF_BEGINSPELL2;
	end;
OnTimer3000:
	donpcevent "#tteffect03::OnEnable";
	end;
}

tha_t12,125,52,0	script	#tteffect04	139,{
	end;
OnEnable:
	initnpctimer;
	end;
OnStop:
	stopnpctimer;
	end;
OnTimer500:
OnTimer1000:
OnTimer1500:
OnTimer2000:
OnTimer2500:
	specialeffect EF_BEGINSPELL3;
	end;
OnTimer3000:
	donpcevent "#tteffect04::OnEnable";
	end;
}

tha_t12,129,56,0	script	#tteffect05	139,{
	end;
OnEnable:
	initnpctimer;
	end;
OnStop:
	stopnpctimer;
	end;
OnTimer500:
OnTimer1000:
OnTimer1500:
OnTimer2000:
OnTimer2500:
	specialeffect EF_BEGINSPELL7;
	end;
OnTimer3000:
	donpcevent "#tteffect05::OnEnable";
	end;
}

tha_t12,130,52,0	script	#gateto_thanatos	45,1,1,{
	end;
OnInit:
	disablenpc "#gateto_thanatos";
	end;
OnEnable:
	enablenpc "#gateto_thanatos";
OnOn2:
	initnpctimer;
	end;
OnTouch:
	set .@touch,1;
OnTimer6000:
	if (($@thana_summon == 0) || ($@thana_summon == 6)) {
		disablenpc "#gateto_thanatos";
		stopnpctimer;
	} else if ($@thana_summon == 5) {
		if (.@touch) warp "thana_boss",136,116;
		else donpcevent "#gateto_thanatos::OnOn2";
	}
	end;
OnTimer1000:
OnTimer5000:
	set .@pillar,1;
OnTimer3000:
	specialeffect EF_BEGINSPELL7,AREA,"#tteffect05";
	specialeffect EF_BEGINSPELL3,AREA,"#tteffect04";
	specialeffect EF_BEGINSPELL2,AREA,"#tteffect03";
	specialeffect EF_BEGINSPELL4,AREA,"#tteffect02";
	specialeffect EF_BEGINSPELL5,AREA,"#tteffect01";
	if (.@pillar) specialeffect EF_MAPPILLAR2;
	end;
}

thana_boss,217,167,3	script	紋路#tt1	1711,3,3,{
	end;
OnEnable:
	hideoffnpc strnpcinfo(0);
	set .hide,0;
	end;
OnDisable:
	hideonnpc strnpcinfo(0);
	set .hide,0;
	end;
OnTouch:
	set .@seal, atoi(charat(strnpcinfo(2),2));
	if (.hide & (1<<.@seal)) end;

	//  .@i: ItemID,MobID,MapX,MapY,EffectNum
	// .@j$: FragmentName
	switch(.@seal) {
	case 1:
		setarray .@i[0],7437,1711,217,167,238;
		set .@j$,"悲哀";
		break;
	case 2:
		setarray .@i[0],7436,1712,202,75,102;
		set .@j$,"苦惱";
		break;
	case 3:
		setarray .@i[0],7438,1709,80,76,101;
		set .@j$,"憎恨";
		break;
	case 4:
		setarray .@i[0],7439,1710,62,171,100;
		set .@j$,"絕望";
		break;
	}

	specialeffect EF_GUMGANG;
	if ($@thana_summon2 > 3) {
		mes "^3355FFYou cannot approach";
		mes "the crest because it is";
		mes "generating intense heat.^000000";
		close;
	}
	mes "The seal seems to be dormant.";
	mes "There is a fragment missing from the crest of the Seal.";
	mes "Surely I saw a familiar fragment before...";
	next;
	input .@inputstr$;
	set .@exact_tt$, ""+.@j$+"的碎片";
	if (countitem(.@i[0]) > 0 && .@exact_tt$ == .@inputstr$) {
		mes "^3355FFYou insert the";
		mes .@exact_tt$;
		mes "into the crest, causing";
		mes "its glow to intensify.^000000";
		close2;
		hideonnpc strnpcinfo(0);
		set .hide, .hide | (1<<.@seal);
		delitem .@i[0],1;
		specialeffect .@i[4];
		monster "thana_boss",.@i[2],.@i[3],.@j$,.@i[1],1,strnpcinfo(0)+"::OnMyMobDead";
		switch($@thana_summon2) {
			case 0: set .@str$,"... who... released... the... Memory... of... "+.@j$+"...?"; break;
			case 1: set .@str$,"... why... did you... release... the... Memory... of... "+.@j$+"...?"; break;
			case 2: set .@str$,"... ugh... stop it... the Memory of "+.@j$+"..."; break;
			default: set .@str$,"... finally... you released the last piece of Memory..."; break;
		}
		mapannounce "thana_boss",.@str$,bc_map,"0x7b68ee"; //FW_NORMAL 12 0 0
		end;
	}
	mes "^3355FFThat action had no";
	mes "effect. You'll have to";
	mes "try something else.^000000";
	close;

OnMyMobDead:
	set $@thana_summon2, $@thana_summon2+1;
	if ($@thana_summon2 == 4)
		mapwarp "thana_boss","thana_boss",141,228;
	end;
}
thana_boss,202,75,3	duplicate(紋路#tt1)	紋路#tt2	1712,3,3
thana_boss,80,76,7	duplicate(紋路#tt1)	紋路#tt3	1709,3,3
thana_boss,62,171,5	duplicate(紋路#tt1)	紋路#tt4	1710,3,3

thana_boss,141,228,0	script	#thanatos_seal	139,3,3,{
	end;
OnEnable:
	enablenpc "#thanatos_seal";
	end;
OnDisable:
	disablenpc "#thanatos_seal";
	end;
OnTouch:
	if ($@thana_summon2 == 4) {
		initnpctimer;
		donpcevent "紋路#tt5::OnEnable";
		disablenpc "#thanatos_seal";
	}
	end;
OnTimer1000:
	mapannounce "thana_boss","Thanatos : RAWWWWWWWWWWWWWWWWR!",bc_map,"0xff0000"; //FW_NORMAL 12 0 0
	end;
OnTimer4000:
	mapannounce "thana_boss","Thanatos : ... crashed... broken... spread... and come back as tears...",bc_map,"0xff0000"; //FW_NORMAL 12 0 0
	end;
OnTimer7000:
	mapannounce "thana_boss","Thanatos : I live again to fulfill my ambition!",bc_map,"0xff0000"; //FW_NORMAL 12 0 0
	end;
OnTimer10000:
	mapannounce "thana_boss","Thanatos : ... gives off a strong bloody scent... soaked in sorrow...",bc_map,"0xff0000"; //FW_NORMAL 12 0 0
	end;
OnTimer13000:
	mapannounce "thana_boss","Thanatos : I will remove all people who invade this continent again!",bc_map,"0xff0000"; //FW_NORMAL 12 0 0
	end;
OnTimer16000:
	mapannounce "thana_boss","Thanatos : Come, be the first to fall before my might!",bc_map,"0xff0000"; //FW_NORMAL 12 0 0
	donpcevent "紋路#tt5::OnDisable";
	donpcevent "#sommon_thanatos::OnEnable";
	set $@thana_summon2, 5;
	stopnpctimer;
	end;
}

thana_boss,141,235,3	script	紋路#tt5	1708,{
	end;
OnInit:
	disablenpc "紋路#tt5";
	end;
OnEnable:
	enablenpc "紋路#tt5";
	end;
OnDisable:
	disablenpc "紋路#tt5";
	specialeffect EF_ICECRASH;
	end;
}

thana_boss,141,218,0	script	#sommon_thanatos	-1,{
OnEnable:
	specialeffect EF_MAPPILLAR2,AREA,"#sommon_thanatos";
	specialeffect EF_SEISMICWEAPON,AREA,"#sommon_thanatos";
	monster "thana_boss",141,218,"魔劍士 達納托斯的記憶",1708,1,"#sommon_thanatos::OnMyMobDead";
	end;
OnMyMobDead:
	if (mobcount("thana_boss","#sommon_thanatos::OnMyMobDead") < 1) {
		mapannounce "thana_boss","RAWWWWWWWWWWR........ This can't be.........................",bc_map,"0xff0000"; //FW_NORMAL 12 0 0
		donpcevent "#cooltime_thana::OnEnable";
		set $@thana_summon, 6;
	}
	end;
}

thana_boss,1,1,0	script	#cooltime_thana	844,{
	end;
OnInit:
	set $@thana_summon, 0;
	set $@thana_summon2, 0;
	end;
OnEnable:
	initnpctimer;
	end;
OnStop:
	stopnpctimer;
	end;
OnTimer3000:
	mapannounce "thana_boss","Warning!!",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
	end;
OnTimer6000:
	mapannounce "thana_boss","The seal will re-activate in 30 seconds.",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
	end;
OnTimer16000:
	mapannounce "thana_boss","20 seconds left...",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
	end;
OnTimer26000:
	mapannounce "thana_boss","10 seconds left...",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
	end;
OnTimer31000:
	mapannounce "thana_boss","5 seconds.",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
	end;
OnTimer32000:
	mapannounce "thana_boss","4 seconds.",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
	end;
OnTimer33000:
	mapannounce "thana_boss","3 seconds.",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
	end;
OnTimer34000:
	mapannounce "thana_boss","2 seconds.",bc_map,"0x00ff00"; //FW_NORMAL 12 0 0
	end;
OnTimer35000:
	mapannounce "thana_boss","Time's up!",bc_map,"0xff0000"; //FW_NORMAL 12 0 0
	end;
OnTimer36000:
OnTimer37000:
	mapwarp "thana_boss","tha_t12",130,52;
	end;
OnTimer7200000:
	set $@thana_summon, 0;
	set $@thana_summon2, 0;
	donpcevent "紋路#tt1::OnEnable";
	donpcevent "紋路#tt2::OnEnable";
	donpcevent "紋路#tt3::OnEnable";
	donpcevent "紋路#tt4::OnEnable";
	donpcevent "#thanatos_seal::OnEnable";
	stopnpctimer;
	end;
}

tha_scene01,30,30,0	warp	scene	1,1,tha_scene01,131,220
tha_t04,81,36,0	warp	to 5th Floor	1,1,tha_t05,62,8
tha_t06,119,120,0	script	to 7th Floor	45,1,1,{
	end;
OnTouch:
	if (eaclass()&(EAJL_2|EAJL_UPPER) || eaclass()&EAJL_THIRD || ((Class == Job_SuperNovice || Class == Job_Taekwon || Class == Job_Star_Gladiator || Class == Job_Soul_Linker || Class == Job_Ninja || Class == Job_Gunslinger) && BaseLevel > 94)) {
		if (countitem(7425) > 0) {
			mes "The shadow of a Black Key is gleaming in the center of the portal.";
			mes "To pass this way, looks like I need something.";
			next;
			mes "The Black Key reacts to the portal and floats in the air.";
			next;
			mes "The key seems to separate into many particles and suddenly collapses into a ball.";
			mes "The barricade is removed through the power from newly formed black magic gem.";
			close2;
			delitem 7425,1; //Key_Black
			getitem 7430,1; //Magic_Gem_Black
			warp "thana_step",69,369;
			end;
		}
		mes "The shadow of a Black Key is gleaming in the center of the portal.";
		mes "To pass this way, looks like I need something.";
		close;
	}
	mes "A mysterious power is blocking my path.";
	close;
}